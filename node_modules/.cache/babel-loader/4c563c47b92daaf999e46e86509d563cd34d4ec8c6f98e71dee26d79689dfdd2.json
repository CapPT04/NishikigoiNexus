{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate,useSearchParams}from\"react-router-dom\";import{handlePayCallBack}from\"../../../axios/UserService\";import\"./PaymentResponse.scss\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PaymentResponse=()=>{const[result,setResult]=useState(\"\");const[loading,setLoading]=useState(true);const[searchParams]=useSearchParams();const[requestId,setRequestId]=useState(\"\");const navigate=useNavigate();const vnp_Amount=searchParams.get(\"vnp_Amount\");const vnp_OrderInfo=searchParams.get(\"vnp_OrderInfo\");const vnp_PayDate=searchParams.get(\"vnp_PayDate\");const vnp_ResponseCode=searchParams.get(\"vnp_ResponseCode\");const PayCallBack=async info=>{const res=await handlePayCallBack(info);// console.log(res);\nsetResult(res);};useEffect(()=>{const info={vnp_Amount,vnp_OrderInfo,vnp_PayDate,vnp_ResponseCode};const match=vnp_OrderInfo.match(/Request (\\d+)/);setRequestId(match?match[1]:null);console.log(requestId);PayCallBack(info);setTimeout(()=>setLoading(false),5000);},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"screen\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"waiting-screen\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-waiting\",children:\"Pending payment...\"}),/*#__PURE__*/_jsx(\"img\",{src:\"https://cdn.dribbble.com/users/2077073/screenshots/7103423/media/223825c7f91575b639fd71f3accff8f4.gif\",alt:\"\"})]}):result.status===200?/*#__PURE__*/_jsxs(\"div\",{className:\"success-screen\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-success\",children:\"Payment Successful\"}),/*#__PURE__*/_jsx(\"img\",{src:\"https://firebasestorage.googleapis.com/v0/b/nishikigoinexus-fa24.appspot.com/o/sp%2Ffree-check-icon-3278-thumb.png?alt=media&token=b040f1d3-b653-4108-8011-bb7f56bc7172\",alt:\"\"}),setTimeout(()=>navigate(`/DetailRequest?id=${requestId}`),500)]}):/*#__PURE__*/_jsxs(\"div\",{className:\"fail-screen\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-fail\",children:\"Payment Failed\"}),/*#__PURE__*/_jsx(\"img\",{src:\"https://firebasestorage.googleapis.com/v0/b/nishikigoinexus-fa24.appspot.com/o/sp%2Fgui-check-no-icon-512x512-9qqp1ph5.png?alt=media&token=3dcb26f5-9be9-4005-bcbb-cbbcbc94734a\",alt:\"\"}),setTimeout(()=>navigate(`/DetailRequest?id=${requestId}`),500)]})});};export default PaymentResponse;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useSearchParams","handlePayCallBack","jsx","_jsx","jsxs","_jsxs","PaymentResponse","result","setResult","loading","setLoading","searchParams","requestId","setRequestId","navigate","vnp_Amount","get","vnp_OrderInfo","vnp_PayDate","vnp_ResponseCode","PayCallBack","info","res","match","console","log","setTimeout","className","children","src","alt","status"],"sources":["D:/FU/FA24/SWP/NishikigoiNexus/src/components/common/PaymentResponse/PaymentResponse.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\r\nimport { handlePayCallBack } from \"../../../axios/UserService\";\r\nimport \"./PaymentResponse.scss\";\r\n\r\nconst PaymentResponse = () => {\r\n  const [result, setResult] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchParams] = useSearchParams();\r\n  const [requestId, setRequestId] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  const vnp_Amount = searchParams.get(\"vnp_Amount\");\r\n  const vnp_OrderInfo = searchParams.get(\"vnp_OrderInfo\");\r\n  const vnp_PayDate = searchParams.get(\"vnp_PayDate\");\r\n  const vnp_ResponseCode = searchParams.get(\"vnp_ResponseCode\");\r\n\r\n  const PayCallBack = async (info) => {\r\n    const res = await handlePayCallBack(info);\r\n    // console.log(res);\r\n    setResult(res);\r\n  };\r\n  useEffect(() => {\r\n    const info = { vnp_Amount, vnp_OrderInfo, vnp_PayDate, vnp_ResponseCode };\r\n    const match = vnp_OrderInfo.match(/Request (\\d+)/);\r\n    setRequestId(match ? match[1] : null);\r\n    console.log(requestId);\r\n    PayCallBack(info);\r\n    setTimeout(() => setLoading(false), 5000);\r\n  }, []);\r\n  return (\r\n    <div className=\"screen\">\r\n      {loading ? (\r\n        <div className=\"waiting-screen\">\r\n          <div className=\"title-waiting\">Pending payment...</div>\r\n          <img\r\n            src=\"https://cdn.dribbble.com/users/2077073/screenshots/7103423/media/223825c7f91575b639fd71f3accff8f4.gif\"\r\n            alt=\"\"\r\n          />\r\n        </div>\r\n      ) : result.status === 200 ? (\r\n        <div className=\"success-screen\">\r\n          <div className=\"title-success\">Payment Successful</div>\r\n          <img\r\n            src=\"https://firebasestorage.googleapis.com/v0/b/nishikigoinexus-fa24.appspot.com/o/sp%2Ffree-check-icon-3278-thumb.png?alt=media&token=b040f1d3-b653-4108-8011-bb7f56bc7172\"\r\n            alt=\"\"\r\n          />\r\n          {setTimeout(() => navigate(`/DetailRequest?id=${requestId}`), 500)}\r\n        </div>\r\n      ) : (\r\n        <div className=\"fail-screen\">\r\n          <div className=\"title-fail\">Payment Failed</div>\r\n          <img\r\n            src=\"https://firebasestorage.googleapis.com/v0/b/nishikigoinexus-fa24.appspot.com/o/sp%2Fgui-check-no-icon-512x512-9qqp1ph5.png?alt=media&token=3dcb26f5-9be9-4005-bcbb-cbbcbc94734a\"\r\n            alt=\"\"\r\n          />\r\n          {setTimeout(() => navigate(`/DetailRequest?id=${requestId}`), 500)}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentResponse;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}